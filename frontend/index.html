<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini-Jira</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Auth Screen -->
    <div id="auth-screen" class="screen">
        <div class="auth-container">
            <h1>Mini-Jira</h1>

            <!-- Login Form -->
            <div id="login-form" class="auth-form">
                <h2>Вход</h2>
                <form id="login-form-element">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Пароль</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Войти</button>
                </form>
                <p class="auth-switch">
                    Нет аккаунта? <a href="#" id="show-register">Зарегистрироваться</a>
                </p>
                <div id="login-error" class="error-message"></div>
            </div>

            <!-- Register Form -->
            <div id="register-form" class="auth-form" style="display: none;">
                <h2>Регистрация</h2>
                <form id="register-form-element">
                    <div class="form-group">
                        <label for="register-fullname">Полное имя</label>
                        <input type="text" id="register-fullname" required>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Пароль</label>
                        <input type="password" id="register-password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Зарегистрироваться</button>
                </form>
                <p class="auth-switch">
                    Уже есть аккаунт? <a href="#" id="show-login">Войти</a>
                </p>
                <div id="register-error" class="error-message"></div>
                <div id="register-success" class="success-message"></div>
            </div>

            <!-- Email Verification Form -->
            <div id="verify-form" class="auth-form" style="display: none;">
                <h2>Подтверждение Email</h2>
                <p>Проверьте вашу почту и введите код подтверждения из письма.</p>
                <form id="verify-form-element">
                    <div class="form-group">
                        <label for="verify-token">Код подтверждения</label>
                        <input type="text" id="verify-token" placeholder="Вставьте токен из ссылки в письме" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Подтвердить</button>
                </form>
                <p class="auth-switch">
                    <a href="#" id="back-to-login">Вернуться к входу</a>
                </p>
                <div id="verify-error" class="error-message"></div>
                <div id="verify-success" class="success-message"></div>
            </div>
        </div>
    </div>

    <!-- Main App Screen -->
    <div id="app-screen" class="screen" style="display: none;">
        <header class="app-header">
            <h1>Mini-Jira</h1>
            <div style="display: flex; gap: 10px; align-items: center;">
                <button id="manage-teams-btn" class="btn btn-secondary" style="display: none;">Управление
                    командами</button>
                <button id="view-mode-toggle" class="btn btn-secondary">Kanban</button>
                <button id="logout-btn" class="btn btn-secondary">Выйти</button>
            </div>
        </header>

        <main class="app-main">
            <!-- Projects List View -->
            <div id="projects-view" class="view">
                <div class="view-header">
                    <h2>Проекты</h2>
                    <button id="create-project-btn" class="btn btn-primary" style="display: none;">+ Создать
                        проект</button>
                </div>
                <div id="projects-list" class="projects-grid">
                    <!-- Projects will be loaded here -->
                </div>
            </div>

            <!-- Kanban Board View -->
            <div id="kanban-view" class="view" style="display: none;">
                <div class="kanban-container">
                    <!-- Column 1: Projects List -->
                    <div class="kanban-column projects-column">
                        <div class="kanban-column-header">
                            <h3>Проекты</h3>
                        </div>
                        <div id="kanban-projects-list" class="kanban-projects-list">
                            <!-- Projects will be loaded here -->
                        </div>
                    </div>

                    <!-- Column 2: To Do -->
                    <div class="kanban-column">
                        <div class="kanban-column-header">
                            <h3>To Do</h3>
                            <span id="todo-count" class="task-count">0</span>
                        </div>
                        <div id="kanban-todo-tasks" class="kanban-tasks-list" data-status="todo">
                            <!-- Tasks with status 'todo' will be loaded here -->
                        </div>
                    </div>

                    <!-- Column 3: In Progress -->
                    <div class="kanban-column">
                        <div class="kanban-column-header">
                            <h3>In Progress</h3>
                            <span id="in-progress-count" class="task-count">0</span>
                        </div>
                        <div id="kanban-in-progress-tasks" class="kanban-tasks-list" data-status="in_progress">
                            <!-- Tasks with status 'in_progress' will be loaded here -->
                        </div>
                    </div>

                    <!-- Column 4: Done -->
                    <div class="kanban-column">
                        <div class="kanban-column-header">
                            <h3>Done</h3>
                            <span id="done-count" class="task-count">0</span>
                        </div>
                        <div id="kanban-done-tasks" class="kanban-tasks-list" data-status="done">
                            <!-- Tasks with status 'done' will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Create Project Modal -->
            <div id="create-project-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Создать проект</h2>
                        <button class="modal-close" id="close-create-modal">&times;</button>
                    </div>
                    <form id="create-project-form">
                        <div class="form-group">
                            <label for="project-title-input">Название проекта *</label>
                            <input type="text" id="project-title-input" required>
                        </div>
                        <div class="form-group">
                            <label for="project-description-input">Описание</label>
                            <textarea id="project-description-input" rows="4"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="project-status-input">Статус</label>
                            <select id="project-status-input">
                                <option value="active">Активный</option>
                                <option value="inactive">Неактивный</option>
                                <option value="completed">Завершен</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Команды проекта</label>
                            <div id="create-project-teams-checkboxes"
                                style="max-height: 200px; overflow-y: auto; border: 1px solid #dfe1e6; padding: 10px; border-radius: 4px;">
                                <p style="color: #5e6c84; font-size: 14px;">Загрузка команд...</p>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancel-create-project">Отмена</button>
                            <button type="submit" class="btn btn-primary">Создать</button>
                        </div>
                        <div id="create-project-error" class="error-message"></div>
                    </form>
                </div>
            </div>

            <!-- Project Detail View -->
            <div id="project-view" class="view" style="display: none;">
                <div class="view-header">
                    <button id="back-to-projects" class="btn btn-link">← Назад к проектам</button>
                    <div style="flex: 1;">
                        <h2 id="project-title"></h2>
                    </div>
                    <div id="project-actions" style="display: none;">
                        <button id="manage-project-teams-btn" class="btn btn-secondary">Управление командами</button>
                        <button id="edit-project-btn" class="btn btn-secondary"
                            style="margin-left: 10px;">Редактировать</button>
                        <button id="delete-project-btn" class="btn btn-secondary"
                            style="background-color: #de350b; margin-left: 10px;">Удалить</button>
                    </div>
                </div>
                <div id="project-info" class="project-info">
                    <div class="info-section">
                        <h3>Описание</h3>
                        <p id="project-description"></p>
                    </div>
                    <div class="info-section">
                        <h3>Статус</h3>
                        <span id="project-status" class="status-badge"></span>
                    </div>
                </div>
                <div class="tasks-section">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0;">Задачи проекта</h3>
                        <button id="create-task-btn" class="btn btn-primary" style="display: none;">+ Создать
                            задачу</button>
                    </div>
                    <!-- Фильтры задач -->
                    <div id="task-filters" class="task-filters"
                        style="margin-bottom: 20px; padding: 15px; background: #f4f5f7; border-radius: 4px;">
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-bottom: 10px;">
                            <div>
                                <label for="filter-status"
                                    style="display: block; margin-bottom: 5px; font-size: 12px; color: #5e6c84;">Статус</label>
                                <select id="filter-status"
                                    style="width: 100%; padding: 6px; border: 1px solid #dfe1e6; border-radius: 3px;">
                                    <option value="">Все</option>
                                    <option value="todo">To Do</option>
                                    <option value="in_progress">In Progress</option>
                                    <option value="done">Done</option>
                                </select>
                            </div>
                            <div>
                                <label for="filter-priority"
                                    style="display: block; margin-bottom: 5px; font-size: 12px; color: #5e6c84;">Приоритет</label>
                                <select id="filter-priority"
                                    style="width: 100%; padding: 6px; border: 1px solid #dfe1e6; border-radius: 3px;">
                                    <option value="">Все</option>
                                    <option value="0">Обычная</option>
                                    <option value="1">Важно</option>
                                    <option value="2">Очень важно</option>
                                </select>
                            </div>
                            <div>
                                <label for="filter-sort-by"
                                    style="display: block; margin-bottom: 5px; font-size: 12px; color: #5e6c84;">Сортировка</label>
                                <select id="filter-sort-by"
                                    style="width: 100%; padding: 6px; border: 1px solid #dfe1e6; border-radius: 3px;">
                                    <option value="">По умолчанию</option>
                                    <option value="created_at">По дате создания</option>
                                    <option value="title">По названию</option>
                                    <option value="status">По статусу</option>
                                    <option value="priority">По приоритету</option>
                                </select>
                            </div>
                            <div>
                                <label for="filter-sort-order"
                                    style="display: block; margin-bottom: 5px; font-size: 12px; color: #5e6c84;">Порядок</label>
                                <select id="filter-sort-order"
                                    style="width: 100%; padding: 6px; border: 1px solid #dfe1e6; border-radius: 3px;">
                                    <option value="asc">По возрастанию</option>
                                    <option value="desc">По убыванию</option>
                                </select>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="filter-search" placeholder="Поиск по названию или описанию..."
                                style="flex: 1; padding: 6px; border: 1px solid #dfe1e6; border-radius: 3px;">
                            <button id="clear-filters" class="btn btn-secondary"
                                style="padding: 6px 12px;">Очистить</button>
                        </div>
                    </div>
                    <div id="project-tasks-list" class="tasks-list">
                        <!-- Tasks will be loaded here -->
                    </div>
                </div>
                <div class="reports-section" style="margin-top: 30px;">
                    <h3>Отчеты</h3>
                    <div id="reports-content" class="reports-grid">
                        <!-- Reports will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Task Detail View -->
            <div id="task-view" class="view" style="display: none;">
                <div class="view-header">
                    <button id="back-to-project" class="btn btn-link">← Назад к проекту</button>
                    <div style="flex: 1;">
                        <h2 id="task-title"></h2>
                    </div>
                    <div id="task-actions" style="display: none;">
                        <button id="edit-task-btn" class="btn btn-secondary">Редактировать</button>
                        <button id="delete-task-btn" class="btn btn-secondary"
                            style="background-color: #de350b; margin-left: 10px;">Удалить</button>
                    </div>
                </div>
                <div id="task-info" class="task-info">
                    <div class="info-section">
                        <h3>Описание</h3>
                        <p id="task-description"></p>
                    </div>
                    <div class="info-row">
                        <div class="info-item">
                            <h3>Статус</h3>
                            <span id="task-status" class="status-badge"></span>
                        </div>
                        <div class="info-item">
                            <h3>Приоритет</h3>
                            <span id="task-priority"></span>
                        </div>
                    </div>
                    <div class="info-section">
                        <h3>Участники</h3>
                        <div id="task-users" class="users-list">
                            <!-- Users will be loaded here -->
                        </div>
                    </div>
                </div>
                <div class="chat-section">
                    <h3>Чат задачи</h3>
                    <div id="chat-messages" class="chat-messages">
                        <!-- Messages will be loaded here -->
                    </div>
                    <div id="chat-input-container" class="chat-input-container" style="display: none;">
                        <form id="chat-form">
                            <textarea id="chat-input" placeholder="Введите сообщение..." rows="3"></textarea>
                            <button type="submit" class="btn btn-primary">Отправить</button>
                        </form>
                    </div>
                    <div id="chat-no-access" class="info-message" style="display: none;">
                        Вы не являетесь участником этой задачи и не можете отправлять сообщения.
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit Project Modal -->
    <div id="edit-project-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Редактировать проект</h2>
                <button class="modal-close" id="close-edit-project-modal">&times;</button>
            </div>
            <form id="edit-project-form">
                <div class="form-group">
                    <label for="edit-project-title-input">Название проекта *</label>
                    <input type="text" id="edit-project-title-input" required>
                </div>
                <div class="form-group">
                    <label for="edit-project-description-input">Описание</label>
                    <textarea id="edit-project-description-input" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="edit-project-status-input">Статус</label>
                    <select id="edit-project-status-input">
                        <option value="active">Активный</option>
                        <option value="inactive">Неактивный</option>
                        <option value="completed">Завершен</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-edit-project">Отмена</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
                <div id="edit-project-error" class="error-message"></div>
            </form>
        </div>
    </div>

    <!-- Create Task Modal -->
    <div id="create-task-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Создать задачу</h2>
                <button class="modal-close" id="close-create-task-modal">&times;</button>
            </div>
            <form id="create-task-form">
                <div class="form-group">
                    <label for="task-title-input">Название задачи *</label>
                    <input type="text" id="task-title-input" required>
                </div>
                <div class="form-group">
                    <label for="task-description-input">Описание</label>
                    <textarea id="task-description-input" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="task-status-input">Статус *</label>
                    <select id="task-status-input" required>
                        <option value="todo">To Do</option>
                        <option value="in_progress">In Progress</option>
                        <option value="done">Done</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="task-priority-input">Приоритет</label>
                    <input type="number" id="task-priority-input" value="0" min="0" max="10">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-create-task">Отмена</button>
                    <button type="submit" class="btn btn-primary">Создать</button>
                </div>
                <div id="create-task-error" class="error-message"></div>
            </form>
        </div>
    </div>

    <!-- Edit Task Modal -->
    <div id="edit-task-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Редактировать задачу</h2>
                <button class="modal-close" id="close-edit-task-modal">&times;</button>
            </div>
            <form id="edit-task-form">
                <div class="form-group">
                    <label for="edit-task-title-input">Название задачи *</label>
                    <input type="text" id="edit-task-title-input" required>
                </div>
                <div class="form-group">
                    <label for="edit-task-description-input">Описание</label>
                    <textarea id="edit-task-description-input" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="edit-task-status-input">Статус</label>
                    <select id="edit-task-status-input">
                        <option value="todo">To Do</option>
                        <option value="in_progress">In Progress</option>
                        <option value="done">Done</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-task-priority-input">Приоритет</label>
                    <input type="number" id="edit-task-priority-input" min="0" max="10">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-edit-task">Отмена</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
                <div id="edit-task-error" class="error-message"></div>
            </form>
        </div>
    </div>

    <!-- Manage Teams Modal -->
    <div id="manage-teams-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Управление командами</h2>
                <button class="modal-close" id="close-manage-teams-modal">&times;</button>
            </div>
            <div style="margin-bottom: 20px;">
                <button id="create-team-btn" class="btn btn-primary">+ Создать команду</button>
            </div>
            <div id="teams-list">
                <!-- Teams will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Create/Edit Team Modal -->
    <div id="team-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="team-modal-title">Создать команду</h2>
                <button class="modal-close" id="close-team-modal">&times;</button>
            </div>
            <form id="team-form">
                <div class="form-group">
                    <label for="team-name-input">Название команды</label>
                    <select id="team-name-input" required>
                        <option value="">Выберите название</option>
                        <option value="testers">testers</option>
                        <option value="backend">backend</option>
                        <option value="frontend">frontend</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="team-lead-input">Лидер команды</label>
                    <select id="team-lead-input" required>
                        <option value="">Выберите лидера</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="team-project-input">Проект (опционально)</label>
                    <select id="team-project-input">
                        <option value="">Без проекта</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Участники команды</label>
                    <div id="team-users-checkboxes"
                        style="max-height: 200px; overflow-y: auto; border: 1px solid #dfe1e6; padding: 10px; border-radius: 4px;">
                        <!-- User checkboxes will be loaded here -->
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-team-form">Отмена</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
                <div id="team-error" class="error-message"></div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>